<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      :root {
        color-scheme: dark light;
      }
    </style>
  </head>
  <body>
    <table>
      <tr>
        <td><label for="sqft">Square Feet:</label></td>
        <td><input type="text" id="sqft" /></td>
      </tr>
      <tr>
        <td>↕️</td>
      </tr>
      <tr>
        <td><label for="acres">Acres:</label></td>
        <td><input type="text" id="acres" /></td>
      </tr>
      <tr>
        <td><label for="kanal">Kanal:</label></td>
        <td><input type="text" id="kanal" /></td>
      </tr>
      <tr>
        <td><label for="marla">Marla:</label></td>
        <td><input type="text" id="marla" /></td>
      </tr>
      <tr>
        <td><label for="rsqft">Square Feet:</label></td>
        <td><input type="text" id="rsqft" /></td>
      </tr>
    </table>
    <script>
      const sqftsInAcre = 43560
      const sqftsInKanal = sqftsInAcre / 8
      const sqftsInMarla = sqftsInKanal / 20

      sqft.oninput = (e) => {
        sqftValue = Number(sqft.value)
        let invalidInput = false

        if (
          isNaN(sqftValue) ||
          Math.sign(sqftValue) === -1 ||
          !Number.isFinite(sqftValue)
        )
          invalidInput = true

        sqft.style.color = invalidInput ? "red" : ""

        if (invalidInput) return

        acres.style.color = ""
        kanal.style.color = ""
        marla.style.color = ""
        rsqft.style.color = ""

        acres.value = Math.floor(sqftValue / sqftsInAcre)
        kanal.value = Math.floor((sqftValue % sqftsInAcre) / sqftsInKanal)
        marla.value = Math.floor((sqftValue % sqftsInKanal) / sqftsInMarla)
        rsqft.value = Number((sqftValue % sqftsInMarla).toFixed(2))
      }

      acres.oninput =
        kanal.oninput =
        marla.oninput =
        rsqft.oninput =
          () => {
            const acresValue = Number(acres.value)
            const kanalValue = Number(kanal.value)
            const marlaValue = Number(marla.value)
            const rsqftValue = Number(rsqft.value)
            const invalidInputs = [false, false, false, false]

            if (
              isNaN(acresValue) ||
              Math.sign(acresValue) === -1 ||
              !Number.isInteger(acresValue)
            )
              invalidInputs[0] = true
            if (
              isNaN(kanalValue) ||
              Math.sign(kanalValue) === -1 ||
              !Number.isInteger(kanalValue)
            )
              invalidInputs[1] = true
            if (
              isNaN(marlaValue) ||
              Math.sign(marlaValue) === -1 ||
              !Number.isInteger(marlaValue)
            )
              invalidInputs[2] = true
            if (
              isNaN(rsqftValue) ||
              Math.sign(rsqftValue) === -1 ||
              !Number.isFinite(rsqftValue)
            )
              invalidInputs[3] = true

            acres.style.color = invalidInputs[0] ? "red" : ""
            kanal.style.color = invalidInputs[1] ? "red" : ""
            marla.style.color = invalidInputs[2] ? "red" : ""
            rsqft.style.color = invalidInputs[3] ? "red" : ""

            if (invalidInputs.some((e) => e)) return

            sqft.style.color = ""

            sqft.value = Number(
              (
                acresValue * sqftsInAcre +
                kanalValue * sqftsInKanal +
                marlaValue * sqftsInMarla +
                rsqftValue
              ).toFixed(2)
            )
          }
    </script>
  </body>
</html>
